fileVersion: 1
id: 3b0e9d47-9302-4680-849d-d40f683c6073
name: STG_VIP_DEPLETION_JOIN
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: PH_PREPARED_STG_SO
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3451da4-7620-4392-8337-baadb77f750b
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ID_VIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f614810-d35e-4801-81c2-d4a3fcafae25
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 784de661-c1b8-49bb-a300-2932879cbe5d
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ID_VIP_ALT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8204573b-109e-4aeb-83c1-7cf765e7f23e
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82b936cd-2ee3-4209-80d6-910f4c14379f
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ID_VIP_PARENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aebd73f8-57ce-44b5-a743-0cba07c4ed61
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 266d2a16-e481-475f-aed1-5205d3e9d738
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: VARCHAR
        description: ""
        name: SUPPLIER_ITEM_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2f8e646-9880-4b03-b71d-9363fd422b1d
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81e1dc54-67d2-46e1-9c36-73a837604d32
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: DISTRIBUTOR_ITEM_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca936324-1b39-4913-a8e6-7c50835204fb
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a80a3d26-f248-40ec-899d-de0a58bac1da
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: DATE
        description: ""
        name: DEPLETION_YEAR_MON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b546d061-ca3f-411b-895e-35b9bb98e3f2
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4010f702-e661-40a9-829a-8d5a05f29d63
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: DATE
        description: ""
        name: DEPLETION_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3de0b8a6-78f8-4c06-80a3-9d7326680bfb
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ee18b70-c2bb-4f6d-90d2-23eb2bfef760
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: DATE
        description: ""
        name: AUDIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b04008ae-3e20-4708-92dc-068f66248544
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec4cf126-176e-4849-9a65-6d1afe0887a1
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: AUDIT_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cb6a51c-0f16-4267-9352-426f460b6d82
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c94e6c47-74e2-405c-bfb1-99c36f00421f
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: DATE
        description: ""
        name: OUT_AUDIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6014f3d2-b3fd-4c3d-b793-285c8a1cb14c
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b9d5170-75f2-441c-86ad-7f62e84b9191
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: OUT_AUDIT_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f51c7d1-ce85-4f88-9fcf-9a7f56f3e8c4
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebbd0cf4-8b0c-4d85-b9d4-18c662807504
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: DATE
        description: ""
        name: INV_AUDIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c8f2973-9fec-4cef-a37d-8915155c7073
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5073c162-4f69-4d71-a0e8-f3fe67613991
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: INV_AUDIT_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75bf9e9d-85d2-4ef9-91f6-5e30714dbddf
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8812e0d2-801e-4012-8748-eab3f3824956
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: BEGIN_ON_HAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99667402-00ea-4d9e-8d3a-9f4088d55198
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4722e1f3-c2da-4e7d-b793-190fccd1e6a0
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: RECEIPTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc412cc1-11e0-4764-85c8-06d3af2e50b4
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64484a02-4e04-44bc-b14f-6b67a99a8c8e
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: TRANS_IN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6827040-5d14-4aa4-a1c7-c958bf406d8c
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77a23177-0acd-426c-a92d-8df16ba1b5da
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: TRANS_OUT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfaa537b-ccf1-46f0-a8bf-a6f56d0b0af1
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cffde042-998b-4f54-981e-21e87982e411
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: RETURNS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d72db8d2-c76c-4ecb-b74a-b82d4624816f
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4927a3b5-6ed7-418b-97c6-793433432b3c
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: BREAKAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99e0d53d-15a5-400e-b2eb-428915d36150
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1f3e3ac-0d13-42c1-bac7-c4bc54be51f5
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: SAMPLES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af28b4f4-60ce-49e0-817d-971c1ee7a1f9
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c5f65ed-7022-47a9-8cb5-8130043c3759
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: ADJUSTMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4495863-d809-4554-a088-113274ce412b
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f57b6b0-8b5a-425e-a2e1-ef276a3c628a
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: TOTAL_INV_CHG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1de5400-d87a-45ce-ab47-6fec524e4104
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdc4ba92-a9f4-4460-bd9a-d9ed7e987b47
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: TOTAL_SALES_FCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56b07378-8f61-41e5-86e7-26833c093108
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: "\"STG_VIP_DEPLETION_LATEST\".\"TOTAL_SALES\" * \"DIM_ITEM\".\"SU_FCE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a528ec8-66c3-45e9-810e-9187852bad06
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: TOTAL_SALES_CASES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56b07378-8f61-41e5-86e7-26833c093108
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f027a67a-cfbd-4ec4-b0b6-77ac47e35194
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: END_ON_HAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc9f58bd-66b9-4c93-a065-d96e5006e0f6
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 062a6b42-2380-46a3-bacd-f34df6fc82e7
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: ON_ORDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9ebf6f7-c29e-4e4a-8668-1c8ce81c5755
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85f1e8f5-6ede-4134-b3f1-443641a5224d
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: IN_BOND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e61be60e-cb3d-479e-850a-f23358590e7b
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1eabab5-e393-49bb-97ed-5e6f43fd12bd
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: MILITARY_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b99a38d5-b6c5-419d-b419-557ea0492abd
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99a07a1b-45e8-4f51-98f8-2c4c3a629aad
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: MILITARY_OFF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1663cd0c-5a0e-46b8-81f8-94c549ec3428
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a332adf-7017-4f88-8c12-98fcfb5e586c
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: NON_RETAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b33f41f-a790-45d1-8e17-6953be05e5a1
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2732170d-4818-4a04-8517-a44da69ea422
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: SUB_DIST_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52ade632-d4d1-4915-b931-a8ea29f905cf
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62e14d5b-37a7-4006-bedf-f0993bedffc0
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: ON_PREMISE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ba1e849-fe09-42db-9a42-a3f3e42d1684
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcf1934b-b1e4-4ddd-bb24-75cce579043a
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: OFF_PREMISE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6b2b53f-11c1-4ada-a152-16abcb0d0d5f
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 872a96d7-bf87-4309-ab46-f024a46797f0
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ON_PREMISES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f91ff96-0972-46c6-b666-ddb70b6c2a6e
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2d6a04e-7ad8-4f26-964d-11d9fee108cc
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: OFF_PREMISES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3125cf5-5223-47ac-856e-7cb11437bc55
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05a9f166-1fb2-4e47-83d3-ab9903601f89
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: TRANSPORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d1de96d-d390-48bf-8c18-66787b36c130
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e600228-d50e-44d8-9914-3a2d9ff77520
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: OTHER_DIST_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c20697a-47ae-4770-bf9e-5e110ef74cb5
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a01aa15e-04a6-433c-8a36-a8ace878a56c
          stepCounter: 3b0e9d47-9302-4680-849d-d40f683c6073
        config: {}
        dataType: FLOAT
        description: ""
        name: UN_CLASSIFIED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a94fa1d1-b77e-4291-94bb-6d77dbae809f
                stepCounter: 6316464d-6a31-44d1-89c5-0a98f3b1a563
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_ITEM: 3018f1a7-ee58-4387-b7cd-1f7349cb485f
          STG_VIP_DEPLETION_LATEST: 6316464d-6a31-44d1-89c5-0a98f3b1a563
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: PH_PREPARED_SO
            nodeName: DIM_ITEM
          - locationName: PH_PREPARED_STG_SO
            nodeName: STG_VIP_DEPLETION_LATEST
        join:
          joinCondition: |-
            FROM {{ ref('PH_PREPARED_STG_SO', 'STG_VIP_DEPLETION_LATEST') }} "STG_VIP_DEPLETION_LATEST"
            LEFT JOIN {{ ref('PH_PREPARED_SO', 'DIM_ITEM') }} "DIM_ITEM"
                ON "STG_VIP_DEPLETION_LATEST"."SUPPLIER_ITEM_NUMBER" = "DIM_ITEM"."ITEM_NUMBER"
        name: STG_VIP_DEPLETION_JOIN
        noLinkRefs: []
  name: STG_VIP_DEPLETION_JOIN
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
