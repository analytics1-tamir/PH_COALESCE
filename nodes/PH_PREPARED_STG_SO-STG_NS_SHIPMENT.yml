fileVersion: 1
id: 7b5beb0f-ba85-4559-9e18-373f33086f1c
name: STG_NS_SHIPMENT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: NetSuite shipments from transaction nodes and DIM_ITEM for item descriptions.
  isMultisource: false
  locationName: PH_PREPARED_STG_SO
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a348a695-a577-4a2f-b2bf-73a742af5835
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ID_NS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12828497-01ad-4086-b4d1-c0588ab43a0d
                stepCounter: ac292339-1a85-4f83-9273-66fcd4eb8bda
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 732046e2-74f7-4384-92ad-0d589e5b7f4b
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: ID_DISTRIBUTOR_NS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c244eaa-513b-42b4-a18f-912f9b332670
                stepCounter: ac292339-1a85-4f83-9273-66fcd4eb8bda
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 910929e2-b16c-4a2d-9597-65c65a728670
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: ID_PARENT_NS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51848f16-8353-4b58-91be-2b77b27243b4
                stepCounter: c1c48423-16e1-4106-a0fc-c37ba5e63f29
            transform: ""
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 840a24d3-18ef-467e-a22e-e5d2a367aa3b
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: VARCHAR(360)
        description: ""
        name: ID_ITEMFULFILLMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a94654ee-9c94-4cee-b732-47978ea475a6
                stepCounter: ac292339-1a85-4f83-9273-66fcd4eb8bda
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3aa6189-535d-4bd5-bc62-5152fc5aa31e
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: VARCHAR
        description: ""
        name: ITEM_NUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0090760-34f9-4e8f-aec4-2bc160181f48
                stepCounter: 3018f1a7-ee58-4387-b7cd-1f7349cb485f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7db568a6-ed36-4699-ae2d-033f1a08c270
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: BILLING_ADDRESS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccbfeefe-ebb4-4695-8ac0-8f8415709cd6
                stepCounter: ac292339-1a85-4f83-9273-66fcd4eb8bda
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cd4f110-3fc4-45de-b621-5a4f8684a125
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SHIPPING_ADDRESS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a224da5-5427-4f5c-9a78-3aa23f2f697f
                stepCounter: ac292339-1a85-4f83-9273-66fcd4eb8bda
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e2f11bda-2157-44b7-bac1-46e7f0d49726
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: ITEM_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 490526e2-efa3-4564-b583-20d4cc02c498
                stepCounter: 3018f1a7-ee58-4387-b7cd-1f7349cb485f
            transform: ""
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe22793a-160b-4697-8d83-76ac6699dddb
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: VARCHAR
        description: ""
        name: ITEM_DESCRIPTION_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48f8f477-c46f-480c-98c1-2d3c07e0f524
                stepCounter: 3018f1a7-ee58-4387-b7cd-1f7349cb485f
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 8b103a16-98f9-499b-8687-7d7b234563e0
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: ITEM_PRICE_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2a41483-16d8-4f7b-a61f-ec9cd57ee5ff
                stepCounter: 3018f1a7-ee58-4387-b7cd-1f7349cb485f
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 79c48da7-310c-49f1-b735-bdf4bc29e247
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: ORDER_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7978e4a-1780-4599-bd67-2a9f1eaa9f9e
                stepCounter: 5751d605-63d5-4916-9a19-fbaf26bc06b8
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2c880084-a954-4eb1-8fcc-d70d4436b702
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c014daec-fa66-439c-9212-daa33eae438d
                stepCounter: c1c48423-16e1-4106-a0fc-c37ba5e63f29
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c2621832-919a-414c-bd71-639a1e9138c6
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: QUANTITY_BY_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3742d57a-eaf7-4edc-b8bb-2b61d645fa6a
                stepCounter: c1c48423-16e1-4106-a0fc-c37ba5e63f29
            transform: ""
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30d6b2f4-5bd1-47a1-8684-188ddb73667c
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: FLOAT
        description: ""
        name: QUANTITY_BY_FCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3742d57a-eaf7-4edc-b8bb-2b61d645fa6a
                stepCounter: c1c48423-16e1-4106-a0fc-c37ba5e63f29
            transform: "\"STG_NS_TRANSACTIONLINE_LATEST\".\"QUANTITYSHIPRECV\" * \"DIM_ITEM\".\"BOTTLE_FCE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4061e3e7-e71d-43e3-814e-ad9811db7e38
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: FLOAT
        description: ""
        name: QUANTITY_BY_CASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3742d57a-eaf7-4edc-b8bb-2b61d645fa6a
                stepCounter: c1c48423-16e1-4106-a0fc-c37ba5e63f29
            transform: "\"STG_NS_TRANSACTIONLINE_LATEST\".\"QUANTITYSHIPRECV\" * \"DIM_ITEM\".\"BOTTLE_TO_CASE\""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ddec67c3-7cbd-4d2e-9aa1-5d3e8e44102c
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: C7_ORDER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 501ddc3a-0fcb-460d-ba9c-7eea97ba2cc7
                stepCounter: ac292339-1a85-4f83-9273-66fcd4eb8bda
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 07b81f66-e632-4450-8f7b-6afc855b62dc
          stepCounter: 7b5beb0f-ba85-4559-9e18-373f33086f1c
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: ACTUAL_SHIP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7b9a3da-0ba6-4ab2-9632-b2f0b03a74eb
                stepCounter: ac292339-1a85-4f83-9273-66fcd4eb8bda
            transform: ""
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_ITEM: 3018f1a7-ee58-4387-b7cd-1f7349cb485f
          STG_NS_TRANSACTION: ac292339-1a85-4f83-9273-66fcd4eb8bda
          STG_NS_TRANSACTIONLINE_LATEST: c1c48423-16e1-4106-a0fc-c37ba5e63f29
          STG_NS_TRANSACTIONSTATUS: 5751d605-63d5-4916-9a19-fbaf26bc06b8
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: PH_PREPARED_SO
            nodeName: DIM_ITEM
          - locationName: PH_PREPARED_STG_SO
            nodeName: STG_NS_TRANSACTION
          - locationName: PH_PREPARED_STG_SO
            nodeName: STG_NS_TRANSACTIONLINE_LATEST
          - locationName: PH_PREPARED_STG_SO
            nodeName: STG_NS_TRANSACTIONSTATUS
        join:
          joinCondition: |-
            FROM {{ ref('PH_PREPARED_STG_SO', 'STG_NS_TRANSACTION') }} "STG_NS_TRANSACTION"
            INNER JOIN {{ ref('PH_PREPARED_STG_SO', 'STG_NS_TRANSACTIONLINE_LATEST') }} "STG_NS_TRANSACTIONLINE_LATEST"
                ON "STG_NS_TRANSACTION"."ID" = "STG_NS_TRANSACTIONLINE_LATEST"."ID_TRANSACTION"
            LEFT JOIN {{ ref('PH_PREPARED_SO', 'DIM_ITEM') }} "DIM_ITEM"
                ON "STG_NS_TRANSACTIONLINE_LATEST"."ITEM_ID_NS" = "DIM_ITEM"."ID_NS"
            LEFT JOIN {{ ref('PH_PREPARED_STG_SO', 'STG_NS_TRANSACTIONSTATUS') }} "STG_NS_TRANSACTIONSTATUS"
                ON "STG_NS_TRANSACTION"."STATUS" = "STG_NS_TRANSACTIONSTATUS"."ID" AND
                   "STG_NS_TRANSACTION"."TYPE" = "STG_NS_TRANSACTIONSTATUS"."TRANTYPE" AND
                   "STG_NS_TRANSACTION"."CUSTOMTYPE" = "STG_NS_TRANSACTIONSTATUS"."TRANCUSTOMTYPE"
            WHERE "STG_NS_TRANSACTION"."ABBREVTYPE" = 'ITEMSHIP' AND
                  "STG_NS_TRANSACTIONLINE_LATEST"."ITEMTYPE" = 'InvtPart'
        name: STG_NS_SHIPMENT
        noLinkRefs: []
  name: STG_NS_SHIPMENT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
