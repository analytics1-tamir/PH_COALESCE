fileVersion: 1
id: cc95db06-3879-4c08-ab21-a7dba89ed108
name: STG_VIP_DISTRIBUTOR_RANKED
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: PH_PREPARED_STG_SO
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89d95052-ef5d-4ea1-90f9-95002b97d721
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: _FILE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8a30fa5-3ac7-4f1b-8fee-a60dd77c09de
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a98233a-d9ce-4449-bbbd-d877db6f52fd
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: _LINE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89258e41-6071-4e6f-931e-4f3d89150eb8
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85b34a76-a966-4688-9c65-842c4a88f960
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: _MODIFIED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db892b3d-e490-4d51-bd8e-59b7f0828e40
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c83216f-cdb5-4868-a1b9-823b15028b65
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: _FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ce06dcd-3c57-47c8-a691-389022f51da3
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 616d4c54-b862-41f1-a492-629142e793d4
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: RECORD_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73db7bff-7ed0-460a-b8e3-5088de1173e0
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55a61e41-e7ff-4c1c-90f1-b8d1e2162c6e
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: SUPPLIER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b96b222-fc00-4251-abb1-905cd78b8cb7
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41132a13-f472-4416-954d-3121064091ef
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: DISTRIBUTOR_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60ad9707-61ba-40c3-893f-a938f21b714f
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc919d92-e2b6-4e75-b185-22534e7b0096
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: DISTRIBUTOR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbdec52b-a45b-4e98-9069-f7940e83a9c2
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6a71d42-83b5-430d-a31d-acbb92af54a5
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: STREET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc41dbd1-5add-4681-aed1-1c8f2003a1ac
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82011382-ddd1-4d59-9498-3ac6b0e2a887
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83c8e405-5300-4818-bba7-451a26213895
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7c20d85-0dff-40d1-a113-84820d1fb05a
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fe266cb-09d9-4eac-90f5-a659a66e9534
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7236bad-878d-4f84-a329-e3a7d4705ff1
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ZIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1d08bff-3d4e-40fe-973b-bf0758fdf6e2
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c920aba5-da22-46b4-9d43-09a15134cf8a
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bd182c8-689f-46ac-98f7-70b03e41fbfa
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2665d61-2d2a-41da-807e-570cf1995d3f
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: CONTACT_1_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa7ff66f-06dd-4670-a06c-bf1cdb63c27a
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ceafec92-2c96-4e01-aac7-2ccaa4e14602
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: CONTACT_1_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 946bb8a6-0e0b-42f7-8cc8-f0e23816dc9c
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 417f1808-2f32-4575-a3e6-84a4c76e1b2c
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: DISTRIBUTOR_REP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b708a60-d99c-4205-b0ce-0dc21b18d722
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34908627-7a49-492d-a581-e4636e6b9d41
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ISV_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86be8bd8-5a75-49bc-8f35-db98b291b34d
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b18ba102-4463-43e0-9d47-00928c8c2cc8
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: DISTRIBUTOR_RANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89130df8-9253-40da-ba0e-cc5f77f3a33f
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35b46c9c-ad0b-47bc-8592-368d2fc2bf61
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: CERTIFICATION_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ade0755-3acd-446c-a84a-f644e3ccc0ea
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77a6277a-6537-44ac-afa8-f1081bdbdbf9
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PHASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0deebf0d-4c60-445e-bc28-df4245746c8f
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2367bc5b-0cff-4bc8-9bdb-806d856a5ab0
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: DATE
        description: ""
        name: LAST_AUDIT_MONTH_EOM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e812b3da-2e33-4d33-921e-24a91fcaec0c
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa886f9b-c140-41d7-b9cd-8544d8ab57d5
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: LAST_AUDIT_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3fec8cd-88b9-4800-bc2a-eca2928eb578
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78b9416d-9f79-4424-a867-89d4a75dac03
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: DIVISION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c255253-4ba0-4f82-93f9-b147dfde398a
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 249268e0-d43f-4822-8140-0b027d9db162
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: DIVISION_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77f51386-03bb-4364-9eb1-23321562803b
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f19399b5-6ec6-4f06-a761-87e3b9268515
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: AREA_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23222e6c-acbf-472b-8927-b76b73446c37
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 198f19a2-c9fa-4d3a-a905-eaacab2e8122
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: AREA_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15521300-5d79-48ff-b934-ce0c0c3916d6
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbe7ef17-2b23-4683-b0b9-2a95adf21250
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: MARKET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf17f6b9-68e6-4c09-8d2b-cc10da51a81b
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64a55022-c624-40ba-8261-a22419a07caa
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: MARKET_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf28ffc1-0949-4764-9a49-c4434d591588
                stepCounter: f2e47aed-810b-40aa-9cb4-153b8d55fbdc
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0403c342-ec4f-4caf-8e5a-a1804297c099
          stepCounter: cc95db06-3879-4c08-ab21-a7dba89ed108
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: Get the latest distributor from VIP by _MODIFIED
        keyColumnType: None
        name: RANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ROW_NUMBER() OVER (PARTITION BY "DISTRIBUTOR"."DISTRIBUTOR_ID" ORDER BY "DISTRIBUTOR"."_MODIFIED" DESC)
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: PH_RAW_VIP
            nodeName: DISTRIBUTOR
        join:
          joinCondition: FROM {{ ref('PH_RAW_VIP', 'DISTRIBUTOR') }} "DISTRIBUTOR"
        name: STG_VIP_DISTRIBUTOR_RANKED
        noLinkRefs: []
  name: STG_VIP_DISTRIBUTOR_RANKED
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
