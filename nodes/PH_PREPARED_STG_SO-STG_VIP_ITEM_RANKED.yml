fileVersion: 1
id: d98bb9f1-acbd-4af7-a5e2-54015111f42d
name: STG_VIP_ITEM_RANKED
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: PH_PREPARED_STG_SO
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16ca69c2-d7a3-4f54-b9fd-21129b5371a3
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: _FILE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41c8be52-b9ce-46d6-b5e3-c30ce2b51afe
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21c08fb9-00ee-42c9-b5a0-72a581086ccd
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: _LINE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d86bc851-29d7-4878-9fbd-a45ef56eddb6
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8940b78-2085-4ad7-8144-47eb44ace229
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: _MODIFIED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c80860a8-1bcf-43cf-b76b-2c19b4ce690c
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2858e54-75ea-4777-9337-b8e3aa3a8fc2
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: _FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39253534-7f14-4045-b213-7defc31dc74b
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b0fdc7f-8c02-469f-b0f6-58e8bb5ca9a0
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: RECORD_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28f5fff6-d413-4e4b-8ab9-6a5a6f999310
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6a7bb55-1128-4b05-bac0-4825ed0696d9
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: SUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd2decba-79c6-4723-88b7-ffe885759b53
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0003f340-733d-4d38-aec5-871eb0829d60
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: DISTRIBUTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d5d78d0-72b2-4e97-804c-b84e1c3c33c1
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f71c5c7-c060-417a-959d-97a916be9e0c
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: SUPPLIER_ITEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 686ee71c-a287-4ef9-a06f-7c3f477443a5
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f90c9f65-8e9e-4547-8335-0421ab45687e
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: DIST_ITEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 517074cf-dd7e-423a-87e3-9e62d273050f
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f82f25f4-27fa-440b-89d1-6e77ac9b72c8
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe04dbda-3101-40dd-8624-59a42194c447
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04341612-5edb-4d90-b190-386554789d10
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: GTIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 156dc70c-2249-4948-ac2a-450d36cfbd77
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 465b2a63-a5ae-4d18-acf8-9ece2d0d295f
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffa2e1c5-f15d-4633-889c-ea9f6614ae4a
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f26f8d3-9c97-4528-8650-8ace5cfba0b1
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SELL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cdc879e-6c69-4fd5-ab3b-a685d2b43509
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eca3b2fa-204c-4489-9a29-12ca5cafb6b6
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03bae188-bb79-4aca-83d9-956bd636d51f
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2771dcfe-8a56-4e71-9b46-d92517d1e6e7
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CREATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c48e96b0-ebec-4fc1-9017-670ca44287df
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66b50416-ee97-4f80-bb69-45fe2bfcaec3
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: DIST_ITEM_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12ec689f-e89d-49d6-8e49-7d7dc19e1df1
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b74befad-221e-4963-9cca-d740a350cb88
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: FLOAT
        description: ""
        name: PROOF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32c91fb7-213d-43f6-a7a3-48295437b444
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc998117-5bdc-49f3-b7bd-0cb750708a35
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: VINTAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 515402aa-f35a-462f-9df3-b579fe74518b
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16ad4ccd-d9e3-4c10-8964-eb85cc24d44e
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: DIST_ITEM_GTIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: def5568a-77b4-4f03-87ff-5b16620cf1a9
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ba717e3-a94b-4e8d-9905-c9cb773c988b
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: REPACK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30ab096c-58e6-413c-8ad6-9cbf03fff01e
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 16c2c162-b115-49f5-b147-63df567b49cf
          stepCounter: d98bb9f1-acbd-4af7-a5e2-54015111f42d
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: Get the latest item from VIP by _MODIFIED
        keyColumnType: None
        name: RANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 686ee71c-a287-4ef9-a06f-7c3f477443a5
                stepCounter: 3ae61a34-6901-419f-8e92-762301c64772
            transform: ROW_NUMBER() OVER (PARTITION BY "ITEM_MASTER"."SUPPLIER_ITEM" ORDER BY "ITEM_MASTER"."_MODIFIED" DESC)
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: PH_RAW_VIP
            nodeName: ITEM_MASTER
        join:
          joinCondition: FROM {{ ref('PH_RAW_VIP', 'ITEM_MASTER') }} "ITEM_MASTER"
        name: STG_VIP_ITEM_RANKED
        noLinkRefs: []
  name: STG_VIP_ITEM_RANKED
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
